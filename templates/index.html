<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Magazzino</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
    <div class="container">
        <h1 class="mb-4">Gestione Magazzino</h1>

        <!-- Aggiungi prodotto -->
        <h3>Aggiungi Prodotto</h3>
        <form action="/add_product" method="post" class="mb-4">
            <input type="text" name="nome_prodotto" placeholder="Nome prodotto" required>
            <input type="number" name="quantita_prodotto" placeholder="Quantità" min="1" required>
            <button type="submit" class="btn btn-primary">Aggiungi</button>
        </form>

        <!-- Prodotti disponibili -->
        <h3>Prodotti Disponibili</h3>
        <table class="table table-bordered">
            <tr>
                <th>Prodotto</th>
                <th>Quantità</th>
                <th>Modifica</th>
                <th>Elimina</th>
            </tr>
            {% for nome, q in prodotti.items() %}
            <tr>
                <td>{{ nome }}</td>
                <td>{{ q }}</td>
                <td>
                    <form action="/update_product/{{ nome }}" method="post" class="d-flex">
                        <input type="number" name="nuova_quantita" value="{{ q }}" min="0" class="form-control me-2" required>
                        <button type="submit" class="btn btn-warning">Aggiorna</button>
                    </form>
                </td>
                <td>
                    <a href="/delete_product/{{ nome }}" class="btn btn-danger">Elimina</a>
                </td>
            </tr>
            {% endfor %}
        </table>

        <!-- Crea kit -->
        <h3>Crea Kit</h3>
        <form action="/add_kit" method="post" class="mb-4">
            <input type="text" name="nome_persona" placeholder="Nome destinatario" required>
            <input type="number" name="quantita_kit" placeholder="Quantità kit" min="1" required>
            <div class="mb-2">
                {% for nome in prodotti.keys() %}
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" name="prodotti_kit" value="{{ nome }}">
                    <label class="form-check-label">{{ nome }}</label>
                </div>
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-primary">Crea Kit</button>
        </form>

        <!-- Kit creati -->
        <h3>Kit Creati</h3>
        <table class="table table-bordered">
            <tr>
                <th>Destinatario</th>
                <th>Prodotti</th>
                <th>Quantità</th>
                <th>Elimina</th>
            </tr>
            {% for nome, info in kit.items() %}
            <tr>
                <td>{{ nome }}</td>
                <td>{{ info.prodotti | join(', ') }}</td>
                <td>{{ info.quantita }}</td>
                <td>
                    <a href="/delete_kit/{{ nome }}" class="btn btn-danger">Elimina</a>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
</body>
</html>
