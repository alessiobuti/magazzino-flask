<h2>Nuovo Ordine</h2>
<form method="POST" action="/crea_ordine">
  <label>Cliente:</label>
  <input type="text" name="cliente" required>

  <table border="1" cellpadding="5">
    <tr><th>Prodotto</th><th>Disponibili</th><th>Quantità</th><th>Prezzo (€)</th></tr>
    {% for prod in prodotti %}
    <tr>
      <td>{{ prod.nome }}</td>
      <td>{{ prod.quantita_pieni }}</td>
      <td><input type="number" name="prod_{{ prod.id }}" value="0" min="0"></td>
      <td>
        <input type="hidden" name="prezzo_{{ prod.id }}" value="{{ prod.prezzo }}">
        {{ prod.prezzo }}
      </td>
    </tr>
    {% endfor %}
  </table>

  <button type="submit">Crea Ordine</button>
  <a href="/">Torna all'inventario</a>
</form>

<hr>

<h2>📦 Ordini recenti</h2>
<div style="display: flex; flex-wrap: wrap; gap: 15px;">
  {% for ordine in ordini %}
  <div style="border: 2px solid #ccc; border-radius: 12px; padding: 10px; width: 320px; background: {% if ordine.consegnato %}#d4edda{% else %}#fff3cd{% endif %}; box-shadow: 2px 2px 8px rgba(0,0,0,0.1);">
    <strong>Cliente:</strong> {{ ordine.cliente }}<br>
    <strong>Data:</strong> {{ ordine.data }}<br>
    <strong>Totale:</strong> {{ ordine.totale }} €<br>
    <strong>Stato:</strong> {% if ordine.consegnato %}✅ Consegnato{% else %}⏳ In attesa{% endif %}

    <ul>
      {% for item in dettagli[ordine.id] %}
        <li>{{ item.nome }} — {{ item.quantita }} × {{ item.prezzo_unitario }}€</li>
      {% endfor %}
    </ul>

    {% if not ordine.consegnato %}
    <form action="/consegna_ordine/{{ ordine.id }}" method="POST" style="display:inline;">
      <button type="submit" style="background:none; border:none; cursor:pointer;">✅ Segna come consegnato</button>
    </form> |
    {% endif %}

    <form action="/elimina_ordine/{{ ordine.id }}" method="POST" style="display:inline;">
      <button type="submit" style="color:red; background:none; border:none; cursor:pointer;">🗑️ Elimina</button>
    </form>
  </div>
  {% endfor %}
</div>
